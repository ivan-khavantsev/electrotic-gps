
#define F_CPU 16000000UL
#define SSD1306_128_64


#include <avr/io.h>
#include <avr/power.h>
#include <util/delay.h>
#include "font.h"
#include "i2c_master.h"
#include "ssd1306.h"
#include <avr/pgmspace.h>
#include "gfxfont.h"

static void testdrawcircle(void)
{
	for (int16_t i=0; i<64; i+=2)
	{
		drawCircle(128/2, 64/2, i, WHITE);
		display();
		_delay_ms(100);
	}
}

static void testdrawlines(void)
{
	for (int16_t i=0; i<64; i+=8)
	{
		drawLine(0, i, 128, i, WHITE);
		display();
		_delay_ms(50);
	}
	
	for (int16_t i=0; i<128; i+=8)
	{
		drawLine(i, 0, i, 64, WHITE);
		display();
		_delay_ms(50);
	}
}

static void testdrawbitmap(void)
{
	const unsigned char font2[] = {
		0x3E, 0x51, 0x49, 0x45, 0x3E,
		0x00, 0x42, 0x7F, 0x40, 0x00,
		0x72, 0x49, 0x49, 0x49, 0x46,
		0x21, 0x41, 0x49, 0x4D, 0x33,
		0x18, 0x14, 0x12, 0x7F, 0x10,
		0x27, 0x45, 0x45, 0x45, 0x39,
		0x3C, 0x4A, 0x49, 0x49, 0x31,
		0x41, 0x21, 0x11, 0x09, 0x07,
		0x36, 0x49, 0x49, 0x49, 0x36,
		0x46, 0x49, 0x49, 0x29, 0x1E,
		0x00, 0x00, 0x14, 0x00, 0x00,
		0x00, 0x40, 0x34, 0x00, 0x00,
		0x00, 0x08, 0x14, 0x22, 0x41,
		0x14, 0x14, 0x14, 0x14, 0x14,
		0x00, 0x41, 0x22, 0x14, 0x08,
		0x02, 0x01, 0x59, 0x09, 0x06,
		0x3E, 0x41, 0x5D, 0x59, 0x4E,
		0x7C, 0x12, 0x11, 0x12, 0x7C,
		0x7F, 0x49, 0x49, 0x49, 0x36,
	};
	
	int x = 1;
	int y = 1;
	for(int i=0; i<95;i+=5){
		uint8_t bitmap1[5] = {0x00,0x00,0x00,0x00,0x00}; 
		bitmap1[0] = font2[i+0];
		bitmap1[1] = font2[i+1];
		bitmap1[2] = font2[i+2];
		bitmap1[3] = font2[i+3];
		bitmap1[4] = font2[i+4];
		drawBitmap(x,y,bitmap1,8,5,WHITE);
		x+=8;
		if(x>=65){
			x=1;
			y+=8;
		}
		
		
	}

	
	
	display();
}

int main(void)
{
	clock_prescale_set(clock_div_1);
	
	i2c_init();
	_delay_ms(10);
	ssd1306_begin(SSD1306_EXTERNALVCC);
	
    while (1) 
    {
		
		testdrawbitmap();
		_delay_ms(10000);
		testdrawlines();
		_delay_ms(2000);
		testdrawcircle();
		_delay_ms(2000);
		clearDisplay();
    }
}